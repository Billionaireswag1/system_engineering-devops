#!/usr/bin/env bash
# Display all running processes for all users with only USER and COMMAND columns in a hierarchy

echo "USER   COMMAND"
while read -r pid; do
    user=$(ps -o user= -p "$pid" 2>/dev/null)
    cmd=$(tr '\0' ' ' < "/proc/$pid/cmdline" 2>/dev/null)
    if [ -n "$user" ] && [ -n "$cmd" ]; then
        echo "$user $cmd"
    fi
done < <(ls /proc | grep -E '^[0-9]+$')
